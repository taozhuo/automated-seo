{
  "id": 4214192,
  "title": "Questions about Luau VMs, Luau threads, and OS threads",
  "slug": "questions-about-luau-vms-luau-threads-and-os-threads",
  "url": "https://devforum.roblox.com/t/questions-about-luau-vms-luau-threads-and-os-threads/4214192",
  "category_id": 55,
  "category_name": "Scripting Support",
  "created_at": "2026-01-04T03:59:19.389Z",
  "last_posted_at": "2026-01-08T20:03:30.231Z",
  "views": 146,
  "reply_count": 5,
  "like_count": 1,
  "tags": [],
  "posts": [
    {
      "id": 13626632,
      "username": "Downrest",
      "content_raw": "",
      "content_html": "<p>I believe that Roblox runs on one main (OS) thread, and there are other worker threads which I assume are also OS threads.</p>\n<p>Does a VM only handle one thread (1 VM = 1 OS thread)? If so, do games run on a single VM because there’s only one main thread?</p>\n<p>Do all (non-parallel) scripts run Luau threads that are scheduled to run on the main thread? What about actors, does it create a new VM and therefore use another OS thread everytime to run <code>task.desynchronize</code>? Does it even make a new VM? And about “use another OS thread”, it uses the worker threads right?</p>\n<p>Is a VM is an environment where code is ran? What are threads then, a set of instructions that will be scheduled by the task scheduler under a VM?</p>\n<p>And for Luau threads vs. OS threads, Luau threads are also considered as subthreads because they merely run under the main (OS) thread right? OS threads are the ones that are actually connected to your hardware right?</p>\n<p>Am I using the terminology right orr am I missing something?</p>",
      "created_at": "2026-01-04T03:59:19.622Z",
      "likes": 0,
      "post_number": 1
    },
    {
      "id": 13626883,
      "username": "iATtaCk_Noobsi",
      "content_raw": "",
      "content_html": "<p>I don’t think OS thread is the correct term (Operating System thread?). From what I believe what you mean is, 1 VM = 1 CPU core used. So yes, there’s only 1 VM available to you if you aren’t using any Actors.</p>\n<hr>\n<aside class=\"quote no-group\" data-username=\"Downrest\" data-post=\"1\" data-topic=\"4214192\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/downrest/60/7312052_2.png\" class=\"avatar\"> Down:</div>\n<blockquote>\n<p>Do all (non-parallel) scripts run Luau threads that are scheduled to run on the main thread?</p>\n</blockquote>\n</aside>\n<p>Not entirely sure what you mean here so I assume you mean if there are 2 scripts running, 1 normal and 1 Actor. However the in the Actor thread, you currently haven’t ran any code to desync it. So if that’s what you mean then yes, the code will run on main thread (main CPU core)</p>\n<hr>\n<aside class=\"quote no-group\" data-username=\"Downrest\" data-post=\"1\" data-topic=\"4214192\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/downrest/60/7312052_2.png\" class=\"avatar\"> Down:</div>\n<blockquote>\n<p>What about actors, does it create a new VM and therefore use another OS thread everytime to run <code>task.desynchronize</code>?</p>\n</blockquote>\n</aside>\n<p>Yes, using an Actor creates a new VM that uses a different CPU core than the main CPU core. However <code>task.desynchronize()</code> doesn’t make a new thread, it just starts running code on that different CPU core while the main CPU core is also running, which runs the code in parallel.</p>\n<hr>\n<aside class=\"quote no-group\" data-username=\"Downrest\" data-post=\"1\" data-topic=\"4214192\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/downrest/60/7312052_2.png\" class=\"avatar\"> Down:</div>\n<blockquote>\n<p>Is a VM is an environment where code is ran? What are threads then, a set of instructions that will be scheduled by the task scheduler under a VM?</p>\n</blockquote>\n</aside>\n<p>Yes? If I’ve interpreted what you mean correctly, a VM is where code will be ran. A thread in roblox terms doesn’t actually mean a thread in the normal Computer Science terms. A thread in roblox terms is the code that is currently running that we have coded, or as you said, a set of instructions (that is currently running).</p>\n<hr>\n<aside class=\"quote no-group\" data-username=\"Downrest\" data-post=\"1\" data-topic=\"4214192\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/downrest/60/7312052_2.png\" class=\"avatar\"> Down:</div>\n<blockquote>\n<p>And for Luau threads vs. OS threads, Luau threads are also considered as subthreads because they merely run under the main (OS) thread right? OS threads are the ones that are actually connected to your hardware right?</p>\n</blockquote>\n</aside>\n<p>Honestly no clue what you mean here. Isn’t Luau thread the same as an OS thread? And subthread what? Threads run sequentially, meaning that it only runs 1 by 1, which I’m pretty you already know. And I don’t believe Actors can/will ever run on another devices CPU core. Unless you’re running the Actor on the Client side. Honestly not too sure about that..</p>\n<hr>\nI'm honestly not the best person you should be talking to about parallel coding. If I've interpreted anything you said wrong, sorry. I don't think I've said anything wrong but maybe someone smarter can show up and correct me if I am.",
      "created_at": "2026-01-04T05:00:39.191Z",
      "likes": 0,
      "post_number": 2
    },
    {
      "id": 13627110,
      "username": "Downrest",
      "content_raw": "",
      "content_html": "<aside class=\"quote no-group\" data-username=\"iATtaCk_Noobsi\" data-post=\"2\" data-topic=\"4214192\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/iattack_noobsi/60/7226919_2.png\" class=\"avatar\"> Noob:</div>\n<blockquote>\n<p>I don’t think OS thread is the correct term (Operating System thread?). From what I believe what you mean is, 1 VM = 1 CPU core used. So yes, there’s only 1 VM available to you if you aren’t using any Actors.</p>\n</blockquote>\n</aside>\n<p>Oh? I’ve been seeing it tossed around as a term, here are examples of replies that use the term:</p>\n<aside class=\"quote group-Roblox_Staff quote-modified\" data-username=\"ZenMa1n\" data-post=\"8\" data-topic=\"4023825\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/zenma1n/60/7232261_2.png\" class=\"avatar\"><a href=\"https://devforum.roblox.com/t/microprofiler-data-very-short-1-4-readable-frames/4023825/8\">Microprofiler data very short (1-4 readable frames)</a></div>\n<blockquote>\n<p>(from a Roblox staff btw)</p>\n<p>I’ve just prepared a fix that restores most buffer sizes and rebalances the total memory we allocate between <strong>OS threads</strong>. I tested it on several top games as well as a few random ones, and it looks like it reduces total memory consumption of MP by ~20% compared to the pre-bug state, while allowing us to capture 300+ full frames in heavy scenes, which seems higher than before the bug.</p>\n</blockquote>\n</aside>\n<aside class=\"quote no-group\" data-username=\"12345koip\" data-post=\"5\" data-topic=\"4188928\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/12345koip/60/7256688_2.png\" class=\"avatar\"><a href=\"https://devforum.roblox.com/t/some-questions-about-threads-taskspawn-and-coroutines/4188928/5\">Some questions about threads, task.spawn and coroutines</a></div>\n<blockquote>\n<p>In <em>multithreading</em>, which is probably where you heard about running code alongside the main thread, there are multiple Luau VMs, each running on their own <strong>OS thread</strong>. The main thread here refers to the main Luau VM.</p>\n</blockquote>\n</aside>\n<aside class=\"quote no-group\" data-username=\"2112Jay\" data-post=\"7\" data-topic=\"4188928\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/2112jay/60/7347999_2.png\" class=\"avatar\"><a href=\"https://devforum.roblox.com/t/some-questions-about-threads-taskspawn-and-coroutines/4188928/7\">Some questions about threads, task.spawn and coroutines</a></div>\n<blockquote>\n<p>task.spawn and coroutines are tasks, not <strong>OS threads</strong>, but have independent call stacks.<br>\nServer doesn’t have a render thread; it uses RBX Worker threads and the main thread.<br>\nAll code runs through the scheduler, whether frequent or infrequent.<br>\nMicroprofiler shows tasks, not threads.</p>\n</blockquote>\n</aside>\n<p>I feel like what people mean to say is that OS threads are the ones actually connected to your hardwdare (CPU), while Luau threads (like what is printed from <code>coroutine.running()</code>) are actually just tasks that run under OS threads.</p>\n<aside class=\"quote no-group\" data-username=\"iATtaCk_Noobsi\" data-post=\"2\" data-topic=\"4214192\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/iattack_noobsi/60/7226919_2.png\" class=\"avatar\"> Noob:</div>\n<blockquote>\n<p>Yes, using an Actor creates a new VM that uses a different CPU core than the main CPU core. However <code>task.desynchronize()</code> doesn’t make a new thread, it just starts running code on that different CPU core while the main CPU core is also running, which runs the code in parallel.</p>\n</blockquote>\n</aside>\n<p>A bit confused here, how would it make a new VM without having to make a new thread? If I’m understand this right,</p>\n<pre data-code-wrap=\"lua\"><code class=\"lang-lua\">RNS.RenderStepped:ConnectParallel(function()\n\t-- on a parallel VM? ...worker thread?\n\t\n\ttask.synchronize()\n\t-- oh back to another VM? ...main thread?\nend)\n</code></pre>\n<p>Would these not make a new thread if they have different VMs and are allocated to different CPU cores? Because if it was the same thread, would it not be actual multithreading then?</p>\n<aside class=\"quote no-group\" data-username=\"iATtaCk_Noobsi\" data-post=\"2\" data-topic=\"4214192\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/iattack_noobsi/60/7226919_2.png\" class=\"avatar\"> Noob:</div>\n<blockquote>\n<p>Yes? If I’ve interpreted what you mean correctly, a VM is where code will be ran. A thread in roblox terms doesn’t actually mean a thread in the normal Computer Science terms. A thread in roblox terms is the code that is currently running that we have coded, or as you said, a set of instructions (that is currently running).</p>\n</blockquote>\n</aside>\n<p>Question, if a VM is an environment, then what are OS threads? Does a VM allow an OS thread to be created? Is the VM the OS thread itself? I have no idea what I’m saying, just brainstorming ghsdhds-</p>\n<aside class=\"quote no-group\" data-username=\"iATtaCk_Noobsi\" data-post=\"2\" data-topic=\"4214192\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/iattack_noobsi/60/7226919_2.png\" class=\"avatar\"> Noob:</div>\n<blockquote>\n<p>And I don’t believe Actors can/will ever run on another devices CPU core. Unless you’re running the Actor on the Client side. Honestly not too sure about that..</p>\n</blockquote>\n</aside>\n<p>What do you mean by this?</p>",
      "created_at": "2026-01-04T05:51:44.125Z",
      "likes": 0,
      "post_number": 3
    },
    {
      "id": 13627120,
      "username": "M0N0RAIL_2",
      "content_raw": "",
      "content_html": "<p>Switching back to serial keeps it on the same VM, although now in sequential somewhere else in the scheduler btw, the VM is bound to the actor, so if you want a new VM just create a new actor</p>",
      "created_at": "2026-01-04T05:53:35.894Z",
      "likes": 0,
      "post_number": 4
    },
    {
      "id": 13627179,
      "username": "Downrest",
      "content_raw": "",
      "content_html": "<p>How does that work? If they run on the same VM, how can parallel and serial Luau threads run at the same time under the same VM and assumingly, the same OS/worker thread? Is my assumption that a VM can only run a single OS/worker thread wrong?</p>\n<p>To clarify, this is what I assume to be the case (please correct me if I’m wrong):</p>\n<ul>\n<li>Each VM has an OS thread (e.g. the main thread)</li>\n<li>Luau threads that are running serially run under that OS thread</li>\n<li>When actors make their own VM, they use another OS thread that isn’t the main thread (worker threads)</li>\n<li>Meaning… code running on serial is executed on the main thread, but code running on parallel is executed on one of the worker threads</li>\n</ul>",
      "created_at": "2026-01-04T06:08:35.857Z",
      "likes": 0,
      "post_number": 5
    },
    {
      "id": 13628714,
      "username": "Downrest",
      "content_raw": "",
      "content_html": "<p>I have extra questions.</p>\n<p>I’m aware that if you open the microprofiler, you will see a main thread and then some worker threads. Are these threads connected to a single core each, which means that a core can only have one OS thread? If so, how do actors work? What happens when you have more actors than cores, like say, 64 Actors to 6 cores. This is kinda going back to my original question of, does parallel luau making a new VM mean it makes its own OS thread…? Or does it allocate to an existing OS thread…?</p>",
      "created_at": "2026-01-04T13:54:37.664Z",
      "likes": 0,
      "post_number": 6
    },
    {
      "id": 13661547,
      "username": "M0N0RAIL_2",
      "content_raw": "",
      "content_html": "<p>because they don’t work at the same time<br>\nserial doesn’t run with parallel<br>\nparallel tasks either run before or after serial<br>\nwould remove the whole “serial being safe” stuff<br>\nthat’s why I said somewhere else in the scheduler</p>",
      "created_at": "2026-01-08T18:14:15.964Z",
      "likes": 0,
      "post_number": 7
    },
    {
      "id": 13662443,
      "username": "tlr22",
      "content_raw": "",
      "content_html": "<aside class=\"quote no-group\" data-username=\"Downrest\" data-post=\"6\" data-topic=\"4214192\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/downrest/60/7312052_2.png\" class=\"avatar\"> Down:</div>\n<blockquote>\n<p>Are these threads connected to a single core each, which means that a core can only have one OS thread</p>\n</blockquote>\n</aside>\n<p>To be clear, cores and threads are not generally the same.  A thread is just basically memory required to run a program.  CPUs have a timer inside that runs really fast and interrupt the CPU letting the os step in and flush everything the CPU is actively using to the memory of the thread, before loading the previously flushed memory from another thread back into the CPU and resuming execution.  So threads often switch what core is actually running it.  The OS may have a way to bind a thread to a specific core but it’s almost always better just to let the OS distribute the work across its cores unless you have a good reason not to.  You generally have 1k-100k threads from differing programs running on your computer at any time, but most are either actually inactive or run for only a few instructions making them effectively inactive.  But threads are how the OS shares compute between different programs, and your own program.  So tldr here is that code is memory and so any core that can access it can pick it up (there are security things in your computer though that makes each program usually have its own virtual memory so it can’t read passwords and stuff or break other programs without pretending to be that program, but this probably doesn’t matter for what we are talking about. Threads made by the same program can share memory)</p>\n<aside class=\"quote no-group\" data-username=\"Downrest\" data-post=\"6\" data-topic=\"4214192\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://doy2mn9upadnk.cloudfront.net/user_avatar/devforum.roblox.com/downrest/60/7312052_2.png\" class=\"avatar\"> Down:</div>\n<blockquote>\n<p>This is kinda going back to my original question of, does parallel luau making a new VM mean it makes its own OS thread…? Or does it allocate to an existing OS thread…?</p>\n</blockquote>\n</aside>\n<p>Threads can share memory and running code can be compressed down to just memory (this requires the CPU to push it’s state to memory which is an important part of switching threads, this lets the CPU pick back up exactly where it left off). Because of this they can be transferred to different physical compute cores at nearly no cost (past the cost of switching threads themselves).  It’s generally better to do it this way so you don’t have one core getting light work and do nothing as heavier scheduled cores work on their tasks.</p>\n<p>Threads though DO have a cost.  It takes time to make a thread and because the OS has to step in and run some stuff to safely store actively running code so it can be picked back up, as well as needing to pick the next thread to run on that core there is cost to switching threads.  In general because of these costs game engines spawn a fixed amount of threads up front (usually 1-2 per physical core).  They then schedule jobs on those threads so when one finishes it can grab another.  This is conceptually similar to the OS switching threads but more optimized and tuned specifically for the engine.  And usually it runs the full job, it doesn’t often try to switch jobs out that are active which further helps reduce the cost of switching tasks.  So when you do have any VM at all, it is almost always just going to be sent as a job so each thread can pick it up as it gets to it.  And in turn each thread is managed by the OS.  So an actor is not a thread, but closer to a job that will get scheduled and distributed to actual threads by the job system.</p>\n<p>Tldr; it’s almost ensured that your vms are running on different cores each time they run.  Just probability.</p>",
      "created_at": "2026-01-08T20:03:30.231Z",
      "likes": 0,
      "post_number": 8
    }
  ]
}